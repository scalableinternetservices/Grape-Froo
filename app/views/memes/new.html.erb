<% provide(:title, "New Meme") %>
<div class="row">
  <div class="col-md-12">
    <h2 id="subheader">New Meme</h2>
  </div>
  <div class="text-center col-md-12">
    <%= bootstrap_form_tag url: :memes, method: "post", layout: :inline do %>
        Select Template:<br>
          <input id="typeahead" class="typeahead" type="text" placeholder="Search Templates">
        <br>
        <br>
        <div class="row">
	        <div class="col-md-6">
	        <%= text_field(:meme, :top_caption, :id => "top-line", :placeholder => "Top Text")%>
	        </div>
	        <div class="col-md-6">
	        <%= text_field(:meme, :bottom_caption, :id => "bottom-line", :placeholder => "Bottom Text") %>
	        </div>
	    </div>
	    <br>
        <br>
        <canvas id="meme"></canvas>
     <% end %>
  </div>
</div>
<div class="clearfix"></div>

<% content_for :footerjs do %>
	<%= javascript_include_tag "meme_gen.js" %>

	<!-- for meme_gen.js -->
 	<script>
	  	Meme('http://i.imgur.com/uGNb9El.jpg', 'meme');

		$('#top-line, #bottom-line').keyup(function() {
			Meme('http://i.imgur.com/uGNb9El.jpg', 'meme', $('#top-line').val(), $('#bottom-line').val());
		});
 	</script>

	<!-- for typeahead -->
	<script type="text/javascript">
		var templates = new Bloodhound({
			datumTokenizer: Bloodhound.tokenizers.whitespace,
			queryTokenizer: Bloodhound.tokenizers.whitespace,
			remote: {
				url: '/templates/typeahead/',
				prepare: function(query, settings) {
					settings.url += encodeURIComponent($('#typeahead').val());
					return settings;
				}
			},
			limit: 10
		});
		templates.initialize();

		$('#typeahead').typeahead({
			hint: true,
			highlight: true,
			minLength: 1
		},
		{
			name: 'templates',
			display: 'name',
			source: templates.ttAdapter()
		});
	</script>
<% end %>


